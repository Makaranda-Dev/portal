<script>
  document.addEventListener('DOMContentLoaded', function() {
    const fileId = '1-bTzoAKqs391UJou5yrn2MOPWCR3b5mh5kVrjbZ5cg4'; // Replace with your file ID
    const url = `https://docs.google.com/spreadsheets/d/${fileId}/export?format=xlsx`;

    fetch(url)
      .then(response => response.arrayBuffer()) // Fetch the binary data (xlsx)
      .then(data => {
        // Parse the Excel file
        const workbook = XLSX.read(new Uint8Array(data), { type: 'array' });
        const sheetName = workbook.SheetNames[0]; // Get the first sheet
        const sheet = workbook.Sheets[sheetName];
        const rows = XLSX.utils.sheet_to_json(sheet, { header: 1 }); // Get rows as an array
        const tableBody = document.querySelector('#scheduleTable tbody');
        tableBody.innerHTML = ''; // Clear the table body

        if (rows && rows.length > 1) {
          rows.forEach((row, index) => {
            if (index === 0) return; // Skip the header row

            // Filter out any completely empty cells in the row
            const filteredRow = row.filter(cell => cell !== undefined && cell !== null && cell !== '');

            // Only process rows with data (ignore rows with no content)
            if (filteredRow.length > 0) {
              const tr = document.createElement('tr');

              // Add only up to 4 columns (adjust if you have more columns)
              for (let i = 0; i < 4; i++) {
                if (filteredRow[i] !== undefined) {
                  const td = document.createElement('td');
                  td.textContent = filteredRow[i]; // Set the cell value
                  td.className = 'border px-4 py-2';
                  tr.appendChild(td);
                }
              }

              tableBody.appendChild(tr); // Append the row to the table body
            }
          });
        } else {
          tableBody.innerHTML = '<tr><td colspan="4" class="border px-4 py-2 text-center">No data available</td></tr>';
        }
      })
      .catch(error => console.error('Error loading the Excel file:', error));
  });
</script>
